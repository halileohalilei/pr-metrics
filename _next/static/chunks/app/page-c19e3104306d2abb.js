(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1019:function(e,t,s){Promise.resolve().then(s.bind(s,9699)),Promise.resolve().then(s.bind(s,1959)),Promise.resolve().then(s.bind(s,2194)),Promise.resolve().then(s.bind(s,9763))},9699:function(e,t,s){"use strict";s.d(t,{default:function(){return I}});var i=s(7437),n=s(2265),r=s(5524),a=s(132),o=s(1736),l=s(3584),d=s(6293),c=s(6608),m=s(1601),h=s(1106),u=s(6529),x=s(4479),g=s(7002),p=s(9763),w=s(5671),v=s(9702),j=s(331),f=s(9969),b=s(172),R=s(7357),z=s(6804),y=s(8646),P=s(2868);function E(){let e=(0,y._)(["\n  query FetchPullRequests($owner: String!, $repo: String!, $cursor: String, $limit: Int!) {\n    repository(owner: $owner, name: $repo) {\n      pullRequests(first: $limit, after: $cursor, orderBy: { field: CREATED_AT, direction: DESC }) {\n        pageInfo {\n          hasNextPage\n          endCursor\n        }\n        nodes {\n          number\n          title\n          state\n          createdAt\n          mergedAt\n          closedAt\n          updatedAt\n          author {\n            login\n          }\n          reviews(first: 50) {\n            totalCount\n            nodes {\n              author {\n                login\n              }\n              state\n              createdAt\n              submittedAt\n            }\n          }\n          reviewRequests(first: 10) {\n            totalCount\n          }\n          comments {\n            totalCount\n          }\n          timelineItems(first: 50, itemTypes: [REVIEW_REQUESTED_EVENT, READY_FOR_REVIEW_EVENT]) {\n            nodes {\n              __typename\n              ... on ReadyForReviewEvent {\n                createdAt\n              }\n              ... on ReviewRequestedEvent {\n                createdAt\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return E=function(){return e},e}function T(){let e=(0,y._)(["\n  query FetchTeamMembers($org: String!, $teamSlug: String!, $cursor: String) {\n    organization(login: $org) {\n      team(slug: $teamSlug) {\n        members(first: 100, after: $cursor) {\n          pageInfo {\n            hasNextPage\n            endCursor\n          }\n          nodes {\n            login\n          }\n        }\n      }\n    }\n  }\n"]);return T=function(){return e},e}let D=(0,P.Ps)(E()),F=(0,P.Ps)(T());function C(e){return new Promise(t=>setTimeout(t,e))}async function S(e){let t,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;for(let h=0;h<s;h++)try{return await e()}catch(x){var n,r,a,o,l,d,c,m;if(t=x,(null===(a=x.response)||void 0===a?void 0:null===(r=a.errors)||void 0===r?void 0:null===(n=r[0])||void 0===n?void 0:n.type)==="NOT_FOUND"||(null===(o=x.response)||void 0===o?void 0:o.status)===401)throw x;let e=(null===(l=x.response)||void 0===l?void 0:l.status)===429,u=(null===(d=x.response)||void 0===d?void 0:d.status)===502||(null===(c=x.response)||void 0===c?void 0:c.status)===504||(null===(m=x.message)||void 0===m?void 0:m.includes("timeout"));if((e||u)&&h<s-1){let e=i*Math.pow(2,h);console.warn("Request failed (attempt ".concat(h+1,"/").concat(s,"), retrying in ").concat(e,"ms...")),await C(e);continue}throw x}throw t}async function A(e,t,s,i,n){let r=[],a=!0,o=null,l=0;for(console.log("Fetching PRs from ".concat(t,"/").concat(s,"..."));a;)try{l++;let d=await S(async()=>await e.request(D,{owner:t,repo:s,cursor:o,limit:50})),c=d.repository.pullRequests.nodes,m=d.repository.pullRequests.pageInfo,h=c.filter(e=>{let t=new Date(e.createdAt);return t>=i&&t<=n});if(r.push(...h),console.log("Fetched batch ".concat(l,": ").concat(r.length," PRs in date range")),c.length>0&&new Date(c[c.length-1].createdAt)<i){console.log("Reached PRs outside date range, stopping...");break}a=m.hasNextPage,o=m.endCursor,a&&await C(500)}catch(e){var d,c,m,h,u,x;if((null===(m=e.response)||void 0===m?void 0:null===(c=m.errors)||void 0===c?void 0:null===(d=c[0])||void 0===d?void 0:d.type)==="NOT_FOUND")throw Error("Repository not found. Please check organization and repository names.");if((null===(h=e.response)||void 0===h?void 0:h.status)===401)throw Error("Invalid GitHub token. Please check your token.");if((null===(u=e.response)||void 0===u?void 0:u.status)===502||(null===(x=e.response)||void 0===x?void 0:x.status)===504)throw Error("GitHub API timeout. Try reducing the date range or the repository has too many PRs.");throw Error("GitHub API error: ".concat(e.message))}return r}async function Z(e,t,s){try{let n=[],r=!0,a=null;for(console.log("Fetching team members from ".concat(t,"/").concat(s,"..."));r;){var i;let o=await S(async()=>await e.request(F,{org:t,teamSlug:s,cursor:a}));if(!(null===(i=o.organization)||void 0===i?void 0:i.team))return console.warn("Team not found. Showing all reviewers."),[];let l=o.organization.team.members.nodes,d=o.organization.team.members.pageInfo;n.push(...l.map(e=>e.login)),r=d.hasNextPage,a=d.endCursor,r&&await C(500)}return console.log("Found ".concat(n.length," team members")),n}catch(e){return console.warn("Failed to fetch team members. Showing all reviewers."),[]}}function q(e){return 0===e.length?0:e.reduce((e,t)=>e+t,0)/e.length}function N(e){if(0===e.length)return 0;let t=[...e].sort((e,t)=>e-t),s=Math.floor(t.length/2);return t.length%2==0?(t[s-1]+t[s])/2:t[s]}function _(e,t){let s=new Date(e);return(new Date(t).getTime()-s.getTime())/36e5}async function M(e,t,s,i){let n={},r=0,a=0,o=0,l=0,d=0,c=[],m=[],h=[],u=[];for(let t of e){"OPEN"===t.state&&o++,"CLOSED"===t.state&&l++,"MERGED"===t.state&&d++,r+=t.reviews.totalCount,a+=t.comments.totalCount,h.push(t.reviews.totalCount);let e=t.reviews.nodes.filter(e=>e.submittedAt);if(e.length>0){let s=e.sort((e,t)=>new Date(e.submittedAt).getTime()-new Date(t.submittedAt).getTime())[0],i=t.timelineItems.nodes.find(e=>"ReadyForReviewEvent"===e.__typename),n=_(i?i.createdAt:t.createdAt,s.submittedAt);c.push(n)}if(t.mergedAt){let e=_(t.createdAt,t.mergedAt);m.push(e);let s=t.reviews.nodes.filter(e=>"APPROVED"===e.state);u.push(s.length)}for(let e of t.reviews.nodes){var x;if(e.author&&e.author.login!==(null===(x=t.author)||void 0===x?void 0:x.login)){let s=e.author.login;n[s]||(n[s]={name:s,totalReviews:0,approved:0,changesRequested:0,commented:0,dismissed:0,pending:0,prsReviewed:new Set}),n[s].totalReviews++,n[s].prsReviewed.add(t.number),"APPROVED"===e.state&&n[s].approved++,"CHANGES_REQUESTED"===e.state&&n[s].changesRequested++,"COMMENTED"===e.state&&n[s].commented++,"DISMISSED"===e.state&&n[s].dismissed++,"PENDING"===e.state&&n[s].pending++}}}let g=Object.values(n);return i.length>0&&(g=g.filter(e=>i.includes(e.name))),g.forEach(e=>{e.uniquePRs=e.prsReviewed.size,delete e.prsReviewed}),g.sort((e,t)=>t.totalReviews-e.totalReviews),{reviewers:g,totalPRs:e.length,openPRs:o,closedPRs:l,mergedPRs:d,totalReviews:r,totalComments:a,teamFilter:i.length>0?"filtered":"",timing:{timeToFirstReview:{average:q(c),median:N(c)},timeToMerge:{average:q(m),median:N(m)}},distribution:{reviewsPerPR:{average:q(h),median:N(h)},approvalsBeforeMerge:{average:q(u)}}}}function k(e){return 0===e?"0 hours":e<1?"".concat(Math.round(60*e)," minutes"):e<24?"".concat(e.toFixed(1)," hours"):"".concat(Math.floor(e/24),"d ").concat(Math.round(e%24),"h")}function I(){let[e,t]=(0,n.useState)(""),[s,y]=(0,n.useState)(""),[E,T]=(0,n.useState)(""),[D,F]=(0,n.useState)(""),C=(0,r.D)({mutationFn:async e=>{let{org:t,repo:s,token:i,since:n,until:r,team:a}=e,o=new P.g6("https://api.github.com/graphql",{headers:{authorization:"Bearer ".concat(i)}}),l=await A(o,t,s,n,r);if(0===l.length)throw Error("No pull requests found in the specified date range.");let d=[];return a&&(d=await Z(o,t,a)),await M(l,n,r,d)},onError:e=>{F(e.message)},onSuccess:()=>{F("")}}),S=e=>{t(e),e&&(y(""),T(""))},q=(e,s)=>{"start"===e?y(s):T(s),s&&t("")},N=async t=>{let i,n;t.preventDefault();let r=new FormData(t.currentTarget),a=r.get("org").trim(),o=r.get("repo").trim(),l=r.get("token").trim(),d=r.get("team").trim();if(e){let t=new Date;i=new Date(t.getTime()-864e5*parseInt(e)),n=t}else if(s&&E)i=new Date(s),(n=new Date(E)).setHours(23,59,59,999);else{F("Please specify either a date range or number of days.");return}C.mutate({org:a,repo:o,token:l,since:i,until:n,team:d})};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("form",{onSubmit:N,children:(0,i.jsxs)(a.K,{gap:"md",children:[(0,i.jsx)(o.o,{label:"Organization Name",name:"org",placeholder:"e.g., facebook",required:!0,leftSection:(0,i.jsx)(f.Z,{size:16})}),(0,i.jsx)(o.o,{label:"Repository Name",name:"repo",placeholder:"e.g., react",required:!0,leftSection:(0,i.jsx)(f.Z,{size:16})}),(0,i.jsx)(l.W,{label:"GitHub Token",name:"token",placeholder:"Your GitHub personal access token",required:!0,description:"Token needs 'repo' and 'read:org' scopes"}),(0,i.jsxs)("div",{children:[(0,i.jsx)(d.x,{size:"sm",fw:500,mb:"xs",children:"Date Range"}),(0,i.jsxs)(c.Z,{grow:!0,align:"flex-start",mb:"xs",children:[(0,i.jsx)(o.o,{label:"From",type:"date",name:"startDate",value:s,onChange:e=>q("start",e.target.value),leftSection:(0,i.jsx)(b.Z,{size:16})}),(0,i.jsx)(o.o,{label:"To",type:"date",name:"endDate",value:E,onChange:e=>q("end",e.target.value),leftSection:(0,i.jsx)(b.Z,{size:16})})]}),(0,i.jsx)(m.i,{label:"OR",labelPosition:"center",my:"md"}),(0,i.jsx)(h.Y,{label:"Number of Days (from today)",name:"numDays",placeholder:"e.g., 30",min:1,value:e,onChange:e=>S(String(e)),leftSection:(0,i.jsx)(b.Z,{size:16})})]}),(0,i.jsx)(o.o,{label:"Team Name (optional)",name:"team",placeholder:"e.g., frontend-team",description:"Filter reviewers by team name. Leave empty to show all reviewers.",leftSection:(0,i.jsx)(R.Z,{size:16})}),(0,i.jsx)(u.z,{type:"submit",fullWidth:!0,size:"lg",loading:C.isPending,gradient:{from:"violet",to:"grape",deg:135},variant:"gradient",children:"See Metrics"})]})}),C.isPending&&(0,i.jsx)(c.Z,{justify:"center",mt:"xl",children:(0,i.jsxs)(a.K,{align:"center",gap:"sm",children:[(0,i.jsx)(x.a,{size:"lg",type:"bars"}),(0,i.jsx)(d.x,{c:"dimmed",children:"Fetching PR reviews via GraphQL..."})]})}),D&&(0,i.jsx)(g.b,{icon:(0,i.jsx)(z.Z,{size:16}),title:"Error",color:"red",mt:"md",children:D}),C.isSuccess&&C.data&&(0,i.jsxs)(a.K,{gap:"xl",mt:"xl",children:[(0,i.jsx)(p.Title,{order:2,ta:"center",children:"PR Review Metrics"}),(0,i.jsx)(w.Z,{shadow:"sm",p:"lg",radius:"md",withBorder:!0,style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},children:(0,i.jsxs)(v.r,{gutter:"md",children:[(0,i.jsx)(v.r.Col,{span:{base:12,xs:6,sm:4,md:3},children:(0,i.jsxs)(a.K,{align:"center",gap:4,children:[(0,i.jsx)(d.x,{size:"xl",fw:700,c:"white",children:C.data.totalPRs}),(0,i.jsx)(d.x,{size:"sm",c:"white",opacity:.9,children:"Total PRs"})]})}),(0,i.jsx)(v.r.Col,{span:{base:12,xs:6,sm:4,md:3},children:(0,i.jsxs)(a.K,{align:"center",gap:4,children:[(0,i.jsx)(d.x,{size:"xl",fw:700,c:"white",children:C.data.openPRs}),(0,i.jsx)(d.x,{size:"sm",c:"white",opacity:.9,children:"Open"})]})}),(0,i.jsx)(v.r.Col,{span:{base:12,xs:6,sm:4,md:3},children:(0,i.jsxs)(a.K,{align:"center",gap:4,children:[(0,i.jsx)(d.x,{size:"xl",fw:700,c:"white",children:C.data.mergedPRs}),(0,i.jsx)(d.x,{size:"sm",c:"white",opacity:.9,children:"Merged"})]})}),(0,i.jsx)(v.r.Col,{span:{base:12,xs:6,sm:4,md:3},children:(0,i.jsxs)(a.K,{align:"center",gap:4,children:[(0,i.jsx)(d.x,{size:"xl",fw:700,c:"white",children:C.data.closedPRs}),(0,i.jsx)(d.x,{size:"sm",c:"white",opacity:.9,children:"Closed"})]})}),(0,i.jsx)(v.r.Col,{span:{base:12,xs:6,sm:4,md:3},children:(0,i.jsxs)(a.K,{align:"center",gap:4,children:[(0,i.jsx)(d.x,{size:"xl",fw:700,c:"white",children:C.data.totalReviews}),(0,i.jsx)(d.x,{size:"sm",c:"white",opacity:.9,children:"Total Reviews"})]})}),(0,i.jsx)(v.r.Col,{span:{base:12,xs:6,sm:4,md:3},children:(0,i.jsxs)(a.K,{align:"center",gap:4,children:[(0,i.jsx)(d.x,{size:"xl",fw:700,c:"white",children:C.data.totalComments}),(0,i.jsx)(d.x,{size:"sm",c:"white",opacity:.9,children:"Total Comments"})]})}),(0,i.jsx)(v.r.Col,{span:{base:12,xs:6,sm:4,md:3},children:(0,i.jsxs)(a.K,{align:"center",gap:4,children:[(0,i.jsx)(d.x,{size:"xl",fw:700,c:"white",children:C.data.reviewers.length}),(0,i.jsxs)(d.x,{size:"sm",c:"white",opacity:.9,children:["Reviewers",C.data.teamFilter?" (Team)":""]})]})})]})}),(0,i.jsxs)(w.Z,{shadow:"sm",p:"lg",radius:"md",withBorder:!0,children:[(0,i.jsx)(p.Title,{order:3,size:"h4",mb:"md",children:"⏱️ Review Timing"}),(0,i.jsxs)(a.K,{gap:"xs",children:[(0,i.jsxs)(c.Z,{justify:"space-between",children:[(0,i.jsx)(d.x,{size:"sm",c:"dimmed",children:"Time to First Review (avg)"}),(0,i.jsx)(d.x,{size:"sm",fw:600,children:k(C.data.timing.timeToFirstReview.average)})]}),(0,i.jsxs)(c.Z,{justify:"space-between",children:[(0,i.jsx)(d.x,{size:"sm",c:"dimmed",children:"Time to First Review (median)"}),(0,i.jsx)(d.x,{size:"sm",fw:600,children:k(C.data.timing.timeToFirstReview.median)})]}),(0,i.jsxs)(c.Z,{justify:"space-between",children:[(0,i.jsx)(d.x,{size:"sm",c:"dimmed",children:"Time to Merge (avg)"}),(0,i.jsx)(d.x,{size:"sm",fw:600,children:k(C.data.timing.timeToMerge.average)})]}),(0,i.jsxs)(c.Z,{justify:"space-between",children:[(0,i.jsx)(d.x,{size:"sm",c:"dimmed",children:"Time to Merge (median)"}),(0,i.jsx)(d.x,{size:"sm",fw:600,children:k(C.data.timing.timeToMerge.median)})]})]})]}),(0,i.jsxs)(w.Z,{shadow:"sm",p:"lg",radius:"md",withBorder:!0,children:[(0,i.jsx)(p.Title,{order:3,size:"h4",mb:"md",children:"\uD83D\uDCC8 Review Distribution"}),(0,i.jsxs)(a.K,{gap:"xs",children:[(0,i.jsxs)(c.Z,{justify:"space-between",children:[(0,i.jsx)(d.x,{size:"sm",c:"dimmed",children:"Reviews per PR (avg)"}),(0,i.jsx)(d.x,{size:"sm",fw:600,children:C.data.distribution.reviewsPerPR.average.toFixed(1)})]}),(0,i.jsxs)(c.Z,{justify:"space-between",children:[(0,i.jsx)(d.x,{size:"sm",c:"dimmed",children:"Reviews per PR (median)"}),(0,i.jsx)(d.x,{size:"sm",fw:600,children:C.data.distribution.reviewsPerPR.median.toFixed(1)})]}),(0,i.jsxs)(c.Z,{justify:"space-between",children:[(0,i.jsx)(d.x,{size:"sm",c:"dimmed",children:"Approvals before merge (avg)"}),(0,i.jsx)(d.x,{size:"sm",fw:600,children:C.data.distribution.approvalsBeforeMerge.average.toFixed(1)})]})]})]}),(0,i.jsx)(p.Title,{order:3,size:"h4",mt:"md",children:"\uD83D\uDC65 Reviewers"}),0===C.data.reviewers.length?(0,i.jsx)(d.x,{ta:"center",c:"dimmed",py:"xl",children:"No reviewers found in the specified criteria."}):(0,i.jsx)(a.K,{gap:"md",children:C.data.reviewers.map(e=>{let t=(e.approved/e.totalReviews*100).toFixed(1),s=(e.changesRequested/e.totalReviews*100).toFixed(1),n=(e.commented/e.totalReviews*100).toFixed(1),r=(e.dismissed/e.totalReviews*100).toFixed(1),o=(e.pending/e.totalReviews*100).toFixed(1);return(0,i.jsxs)(w.Z,{shadow:"sm",p:"lg",radius:"md",withBorder:!0,style:{borderLeft:"4px solid var(--mantine-color-violet-6)"},children:[(0,i.jsx)(p.Title,{order:4,size:"h5",mb:"md",children:e.name}),(0,i.jsxs)(a.K,{gap:"sm",children:[(0,i.jsxs)(c.Z,{justify:"space-between",children:[(0,i.jsx)(d.x,{size:"sm",c:"dimmed",children:"Total Reviews"}),(0,i.jsx)(d.x,{size:"sm",fw:600,children:e.totalReviews})]}),(0,i.jsxs)(c.Z,{justify:"space-between",children:[(0,i.jsx)(d.x,{size:"sm",c:"dimmed",children:"Unique PRs Reviewed"}),(0,i.jsx)(d.x,{size:"sm",fw:600,children:e.uniquePRs})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)(c.Z,{justify:"space-between",mb:5,children:[(0,i.jsx)(d.x,{size:"sm",c:"dimmed",children:"Approved"}),(0,i.jsxs)(d.x,{size:"sm",fw:600,children:[e.approved," (",t,"%)"]})]}),(0,i.jsx)(j.E,{value:parseFloat(t),size:"lg",radius:"xl",color:"violet"})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)(c.Z,{justify:"space-between",mb:5,children:[(0,i.jsx)(d.x,{size:"sm",c:"dimmed",children:"Changes Requested"}),(0,i.jsxs)(d.x,{size:"sm",fw:600,children:[e.changesRequested," (",s,"%)"]})]}),(0,i.jsx)(j.E,{value:parseFloat(s),size:"lg",radius:"xl",color:"violet"})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)(c.Z,{justify:"space-between",mb:5,children:[(0,i.jsx)(d.x,{size:"sm",c:"dimmed",children:"Commented"}),(0,i.jsxs)(d.x,{size:"sm",fw:600,children:[e.commented," (",n,"%)"]})]}),(0,i.jsx)(j.E,{value:parseFloat(n),size:"lg",radius:"xl",color:"violet"})]}),e.dismissed>0&&(0,i.jsxs)("div",{children:[(0,i.jsxs)(c.Z,{justify:"space-between",mb:5,children:[(0,i.jsx)(d.x,{size:"sm",c:"dimmed",children:"Dismissed"}),(0,i.jsxs)(d.x,{size:"sm",fw:600,children:[e.dismissed," (",r,"%)"]})]}),(0,i.jsx)(j.E,{value:parseFloat(r),size:"lg",radius:"xl",color:"violet"})]}),e.pending>0&&(0,i.jsxs)("div",{children:[(0,i.jsxs)(c.Z,{justify:"space-between",mb:5,children:[(0,i.jsx)(d.x,{size:"sm",c:"dimmed",children:"Pending"}),(0,i.jsxs)(d.x,{size:"sm",fw:600,children:[e.pending," (",o,"%)"]})]}),(0,i.jsx)(j.E,{value:parseFloat(o),size:"lg",radius:"xl",color:"violet"})]})]})]},e.name)})})]})]})}}},function(e){e.O(0,[380,964,971,23,744],function(){return e(e.s=1019)}),_N_E=e.O()}]);